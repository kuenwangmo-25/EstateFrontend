{"version":3,"sources":["dist/pop.js"],"names":["global","factory","exports","module","define","amd","Pop","this","clone","target","source","obj","i","eventListener","event","currentTarget","events","type","updateAttribute","element","name","value","oldValue","isSVG","style","setProperty","slice","addEventListener","removeEventListener","setAttribute","removeAttribute","removeElement","parent","node","done","removeChild","removeChildren","attributes","children","length","childNodes","ondestroy","cb","onremove","getKey","key","patchElement","oldNode","lifecycle","isRecycling","nodeName","newElement","createElement","document","createTextNode","createElementNS","oncreate","push","appendChild","insertBefore","nodeValue","oldAttributes","onupdate","updateElement","oldKeyed","newKeyed","oldElements","oldChildren","oldKey","k","newKey","keyedNode","patch","parentNode","recycleElement","map","toLowerCase","call","nodeType","pop","h","rest","arguments","create","state","view"],"mappings":"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","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.Pop = factory());\n}(this, (function () { 'use strict';\n\nfunction h(name, attributes) {\n  var rest = [];\n  var children = [];\n  var length = arguments.length;\n\n  while (length-- > 2) rest.push(arguments[length]);\n\n  while (rest.length) {\n    var node = rest.pop();\n    if (node && node.pop) {\n      for (length = node.length; length--; ) {\n        rest.push(node[length]);\n      }\n    } else if (node != null && node !== true && node !== false) {\n      children.push(node);\n    }\n  }\n\n  return typeof name === \"function\"\n    ? name(attributes || {}, children) // h(Component)\n    : {\n        nodeName: name,\n        attributes: attributes || {},\n        children: children,\n        key: attributes && attributes.key\n      }\n}\n\nfunction recycleElement(element, map) {\n  return {\n    nodeName: element.nodeName.toLowerCase(),\n    attributes: {},\n    children: map.call(element.childNodes, function(element) {\n      return element.nodeType === 3 // Node.TEXT_NODE\n        ? element.nodeValue\n        : recycleElement(element, map)\n    })\n  }\n}\n\nfunction clone(target, source) {\n  var obj = {};\n\n  for (var i in target) obj[i] = target[i];\n  for (var i in source) obj[i] = source[i];\n\n  return obj\n}\n\nfunction eventListener(event) {\n  return event.currentTarget.events[event.type](event)\n}\n\nfunction updateAttribute(element, name, value, oldValue, isSVG) {\n  if (name === \"key\") {\n  } else if (name === \"style\") {\n    for (var i in clone(oldValue, value)) {\n      var style = value == null || value[i] == null ? \"\" : value[i];\n      if (i[0] === \"-\") {\n        element[name].setProperty(i, style);\n      } else {\n        element[name][i] = style;\n      }\n    }\n  } else {\n    if (name[0] === \"o\" && name[1] === \"n\") {\n      if (!element.events) {\n        element.events = {};\n      }\n      element.events[(name = name.slice(2))] = value;\n      if (value) {\n        if (!oldValue) {\n          element.addEventListener(name, eventListener);\n        }\n      } else {\n        element.removeEventListener(name, eventListener);\n      }\n    } else if (name in element && name !== \"list\" && !isSVG) {\n      element[name] = value == null ? \"\" : value;\n    } else if (value != null && value !== false) {\n      element.setAttribute(name, value);\n    }\n\n    if (value == null || value === false) {\n      element.removeAttribute(name);\n    }\n  }\n}\n\nfunction createElement(node, lifecycle, isSVG) {\n  var element =\n    typeof node === \"string\" || typeof node === \"number\"\n      ? document.createTextNode(node)\n      : (isSVG = isSVG || node.nodeName === \"svg\")\n        ? document.createElementNS(\"http://www.w3.org/2000/svg\", node.nodeName)\n        : document.createElement(node.nodeName);\n\n  var attributes = node.attributes;\n  if (attributes) {\n    if (attributes.oncreate) {\n      lifecycle.push(function() {\n        attributes.oncreate(element);\n      });\n    }\n\n    for (var i = 0; i < node.children.length; i++) {\n      element.appendChild(createElement(node.children[i], lifecycle, isSVG));\n    }\n\n    for (var name in attributes) {\n      updateAttribute(element, name, attributes[name], null, isSVG);\n    }\n  }\n\n  return element\n}\n\nfunction removeChildren(element, node) {\n  var attributes = node.attributes;\n  if (attributes) {\n    for (var i = 0; i < node.children.length; i++) {\n      removeChildren(element.childNodes[i], node.children[i]);\n    }\n\n    if (attributes.ondestroy) {\n      attributes.ondestroy(element);\n    }\n  }\n  return element\n}\n\nfunction removeElement(parent, element, node) {\n  function done() {\n    parent.removeChild(removeChildren(element, node));\n  }\n\n  var cb = node.attributes && node.attributes.onremove;\n  if (cb) {\n    cb(element, done);\n  } else {\n    done();\n  }\n}\n\nfunction updateElement(\n  element,\n  oldAttributes,\n  attributes,\n  lifecycle,\n  isRecycling,\n  isSVG\n) {\n  for (var name in clone(oldAttributes, attributes)) {\n    if (\n      attributes[name] !==\n      (name === \"value\" || name === \"checked\"\n        ? element[name]\n        : oldAttributes[name])\n    ) {\n      updateAttribute(\n        element,\n        name,\n        attributes[name],\n        oldAttributes[name],\n        isSVG\n      );\n    }\n  }\n\n  var cb = isRecycling ? attributes.oncreate : attributes.onupdate;\n  if (cb) {\n    lifecycle.push(function() {\n      cb(element, oldAttributes);\n    });\n  }\n}\n\nfunction getKey(node) {\n  return node ? node.key : null\n}\n\nfunction patchElement(\n  parent,\n  element,\n  oldNode,\n  node,\n  lifecycle,\n  isRecycling,\n  isSVG\n) {\n  if (node === oldNode) {\n  } else if (oldNode == null || oldNode.nodeName !== node.nodeName) {\n    var newElement = createElement(node, lifecycle, isSVG);\n    if (parent) {\n      parent.insertBefore(newElement, element);\n      if (oldNode != null) {\n        removeElement(parent, element, oldNode);\n      }\n    }\n    element = newElement;\n  } else if (oldNode.nodeName == null) {\n    element.nodeValue = node;\n  } else {\n    updateElement(\n      element,\n      oldNode.attributes,\n      node.attributes,\n      lifecycle,\n      isRecycling,\n      (isSVG = isSVG || node.nodeName === \"svg\")\n    );\n\n    var oldKeyed = {};\n    var newKeyed = {};\n    var oldElements = [];\n    var oldChildren = oldNode.children;\n    var children = node.children;\n\n    for (var i = 0; i < oldChildren.length; i++) {\n      oldElements[i] = element.childNodes[i];\n\n      var oldKey = getKey(oldChildren[i]);\n      if (oldKey != null) {\n        oldKeyed[oldKey] = [oldElements[i], oldChildren[i]];\n      }\n    }\n\n    var i = 0;\n    var k = 0;\n\n    while (k < children.length) {\n      var oldKey = getKey(oldChildren[i]);\n      var newKey = getKey(children[k]);\n\n      if (newKeyed[oldKey]) {\n        i++;\n        continue\n      }\n\n      if (newKey == null || isRecycling) {\n        if (oldKey == null) {\n          patchElement(\n            element,\n            oldElements[i],\n            oldChildren[i],\n            children[k],\n            lifecycle,\n            isRecycling,\n            isSVG\n          );\n          k++;\n        }\n        i++;\n      } else {\n        var keyedNode = oldKeyed[newKey] || [];\n\n        if (oldKey === newKey) {\n          patchElement(\n            element,\n            keyedNode[0],\n            keyedNode[1],\n            children[k],\n            lifecycle,\n            isRecycling,\n            isSVG\n          );\n          i++;\n        } else if (keyedNode[0]) {\n          patchElement(\n            element,\n            element.insertBefore(keyedNode[0], oldElements[i]),\n            keyedNode[1],\n            children[k],\n            lifecycle,\n            isRecycling,\n            isSVG\n          );\n        } else {\n          patchElement(\n            element,\n            oldElements[i],\n            null,\n            children[k],\n            lifecycle,\n            isRecycling,\n            isSVG\n          );\n        }\n\n        newKeyed[newKey] = children[k];\n        k++;\n      }\n    }\n\n    while (i < oldChildren.length) {\n      if (getKey(oldChildren[i]) == null) {\n        removeElement(element, oldElements[i], oldChildren[i]);\n      }\n      i++;\n    }\n\n    for (var i in oldKeyed) {\n      if (!newKeyed[i]) {\n        removeElement(element, oldKeyed[i][0], oldKeyed[i][1]);\n      }\n    }\n  }\n  return element\n}\n\nfunction patch(node, element) {\n  var lifecycle = [];\n\n  element = element\n    ? patchElement(\n        element.parentNode,\n        element,\n        element.node == null ? recycleElement(element, [].map) : element.node,\n        node,\n        lifecycle,\n        element.node == null // isRecycling\n      )\n    : patchElement(null, null, null, node, lifecycle);\n\n  element.node = node;\n\n  while (lifecycle.length) lifecycle.pop()();\n\n  return element\n}\n\nvar index = {\n  h: h,\n  create: function(state, view) {\n    var element = patch(view(state), element);\n    return element\n  }\n}\n\nreturn index;\n\n})));\n//# sourceMappingURL=pop.js.map\n"]}